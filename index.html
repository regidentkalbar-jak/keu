<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Catatan Keuangan â€” PWA</title>

  <!-- Fonts & CSS -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="style.css"/>

  <!-- Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>

  <meta name="theme-color" content="#708090"/>
  <link rel="manifest" href="manifest.json"/>
</head>
<body>
  <div class="app-wallpaper"></div>

  <nav class="navbar navbar-dark bg-transparent px-3">
    <a class="navbar-brand d-flex align-items-center">
      <i class="fas fa-wallet me-2 app-icon"></i>
      <span class="app-header">Catatan Keuangan</span>
    </a>

    <div class="ms-auto d-flex align-items-center">
      <label for="monthSelector" class="me-2 small label-month">Pilih Bulan:</label>
      <select id="monthSelector" class="form-select form-select-sm me-3 month-select"></select>

      <div class="btn-group">
        <button id="exportExcelBtn" class="btn btn-gold btn-sm" title="Export ke Excel (.xlsx)"><i class="fa-solid fa-file-excel"></i></button>
        <button id="exportCsvBtn" class="btn btn-gold btn-sm" title="Export ke CSV (.csv)"><i class="fa-solid fa-file-csv"></i></button>
      </div>
    </div>
  </nav>

  <main class="container py-4">
    <!-- Dashboard -->
    <div class="row g-3 mb-4">
      <div class="col-md-4">
        <div class="card dashboard-card dashboard-gray text-black">
          <div class="card-body text-center">
            <i class="fas fa-coins fa-2x mb-2"></i>
            <h6 class="mb-1">Saldo Saat Ini</h6>
            <h3 id="currentBalance" class="fw-bold display-6">Rp 0</h3>
            <small id="startingBalanceInfo" class="text-muted d-block mt-1">Saldo awal: Rp 0</small>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card dashboard-card dashboard-gray text-black">
          <div class="card-body text-center">
            <i class="fas fa-arrow-down fa-2x mb-2"></i>
            <h6 class="mb-1">Total Pemasukan</h6>
            <h3 id="totalIncome" class="fw-bold display-6">Rp 0</h3>
          </div>
        </div>
      </div>

      <div class="col-md-4">
        <div class="card dashboard-card dashboard-gray text-black">
          <div class="card-body text-center">
            <i class="fas fa-arrow-up fa-2x mb-2"></i>
            <h6 class="mb-1">Total Pengeluaran</h6>
            <h3 id="totalExpense" class="fw-bold display-6">Rp 0</h3>
          </div>
        </div>
      </div>
    </div>

    <!-- Entry forms -->
    <div class="row g-3 mb-4">
      <div class="col-md-6">
        <div class="card entry-card entry-green">
          <div class="card-header fw-bold">Tambah Pemasukan</div>
          <div class="card-body">
            <label class="form-label">Tanggal</label>
            <input id="incomeDate" type="date" class="form-control mb-2"/>
            <label class="form-label">Jumlah (Rp)</label>
            <input id="incomeAmount" type="text" class="form-control mb-2" placeholder="Contoh: 1.500.000"/>
            <label class="form-label">Deskripsi</label>
            <input id="incomeDescription" type="text" class="form-control mb-2" placeholder="Contoh: Gaji Bulanan"/>
            <label class="form-label">Kategori</label>
            <select id="incomeCategory" class="form-select mb-3">
              <option>Gaji</option><option>Bonus</option><option>Investasi</option><option>Usaha</option><option>Lainnya</option>
            </select>
            <button id="addIncomeBtn" class="btn btn-gold w-100">Tambah Pemasukan</button>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="card entry-card entry-green">
          <div class="card-header fw-bold">Tambah Pengeluaran</div>
          <div class="card-body">
            <label class="form-label">Tanggal</label>
            <input id="expenseDate" type="date" class="form-control mb-2"/>
            <label class="form-label">Jumlah (Rp)</label>
            <input id="expenseAmount" type="text" class="form-control mb-2" placeholder="Contoh: 50.000"/>
            <label class="form-label">Deskripsi</label>
            <input id="expenseDescription" type="text" class="form-control mb-2" placeholder="Contoh: Transport"/>
            <label class="form-label">Kategori</label>
            <select id="expenseCategory" class="form-select mb-3">
              <option>Makan</option><option>Transportasi</option><option>Hiburan</option><option>Primer</option><option>Sekunder</option><option>Lainnya</option>
            </select>
            <button id="addExpenseBtn" class="btn btn-gold w-100">Tambah Pengeluaran</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Riwayat & Charts -->
    <div class="row g-3 mb-4">
      <div class="col-lg-6">
        <div class="card section-card section-whitesmoke">
          <div class="card-header fw-bold d-flex justify-content-between align-items-center">
            <span>Riwayat Transaksi</span>
            <small id="historyCount" class="text-muted">0 transaksi</small>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive" style="max-height:420px; overflow:auto;">
              <table class="table mb-0 align-middle">
                <thead class="table-light">
                  <tr>
                    <th>Tanggal</th><th>Jenis</th><th>Kategori</th><th>Jumlah</th><th>Deskripsi</th><th>Aksi</th>
                  </tr>
                </thead>
                <tbody id="transactionHistoryBody">
                  <tr><td colspan="6" class="text-center text-muted">Belum ada transaksi.</td></tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card section-card section-whitesmoke mb-3">
          <div class="card-header fw-bold">Distribusi Kategori Pengeluaran</div>
          <div class="card-body"><canvas id="expenseCategoryChart"></canvas></div>
        </div>

        <div class="card section-card section-whitesmoke">
          <div class="card-header fw-bold">Aliran Kas (per bulan)</div>
          <div class="card-body"><canvas id="monthlyFlowChart"></canvas></div>
        </div>
      </div>
    </div>

    <!-- Rekapan -->
    <div class="card section-card section-beige mt-3">
      <div class="card-header fw-bold">Rekapan Bulanan</div>
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table mb-0">
            <thead class="table-light"><tr><th>Bulan</th><th>Pemasukan</th><th>Pengeluaran</th><th>Saldo Akhir</th></tr></thead>
            <tbody id="monthlyRecapBody"><tr><td colspan="4" class="text-center text-muted">Belum ada data.</td></tr></tbody>
          </table>
        </div>
      </div>
    </div>
  </main>

  <!-- Edit Modal (placeholder untuk pengembangan selanjutnya) -->
  <div class="modal fade" id="editModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Transaksi</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Tutup"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="editTxMonth">
          <input type="hidden" id="editTxId">
          <label class="form-label">Jenis</label>
          <select id="editType" class="form-select mb-2"><option value="pemasukan">Pemasukan</option><option value="pengeluaran">Pengeluaran</option></select>
          <label class="form-label">Tanggal</label>
          <input id="editDate" type="date" class="form-control mb-2"/>
          <label class="form-label">Jumlah (Rp)</label>
          <input id="editAmount" type="text" class="form-control mb-2"/>
          <label class="form-label">Kategori</label>
          <input id="editCategory" type="text" class="form-control mb-2"/>
          <label class="form-label">Deskripsi</label>
          <input id="editDescription" type="text" class="form-control mb-2"/>
        </div>
        <div class="modal-footer">
          <button id="saveEditBtn" type="button" class="btn btn-gold">Simpan</button>
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Batal</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <!-- App JS -->
  <script src="script.js"></script>
</body>
</html>
